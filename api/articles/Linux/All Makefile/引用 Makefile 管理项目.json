{"title":"引用 Makefile 管理项目","uid":"26b9a4870bd866c20b3377bf9d2e80e2","slug":"Linux/All Makefile/引用 Makefile 管理项目","date":"2022-02-05T12:49:36.000Z","updated":"2022-02-20T12:58:29.987Z","comments":true,"path":"api/articles/Linux/All Makefile/引用 Makefile 管理项目.json","keywords":null,"cover":"https://s2.loli.net/2022/02/16/T8XPlFvSMEoekdZ.jpg","content":"<h1 id=\"1-搭建简单项目\"><a href=\"#1-搭建简单项目\" class=\"headerlink\" title=\"1.搭建简单项目\"></a><strong>1.搭建简单项目</strong></h1><p>在一个文件夹中新建两个<code>.c</code>文件和一个<code>Makefile</code>文件。<code>Makefile</code>作为 make 编译文件，<code>.c</code>是项目文件。</p>\n<p>这里我们搭建一个<code>main.c</code>和<code>mp3.c</code>，<code>main.c</code>负责调用<code>mp3.c</code>的函数。</p>\n<ul>\n<li><code>main.c</code>：  <pre class=\"line-numbers language-c\" data-language=\"c\"><code class=\"language-c\">#include &lt;stdio.h&gt;\n\nint main(void)\n&#123;\n   play();\n   stop();\n   return 0;\n&#125;</code></pre>\n&nbsp;</li>\n<li><code>mp3.c</code>：  <pre class=\"line-numbers language-c\" data-language=\"c\"><code class=\"language-c\">#include &lt;stdio.h&gt;\n\nvoid play(void)\n&#123;\n    printf(&quot;Play music！\\n&quot;);\n&#125;\n\nvoid stop(void)\n&#123;\n    printf(&quot;Stop music！\\n&quot;);\n&#125;</code></pre></li>\n</ul>\n<h1 id=\"2-makefile-设计\"><a href=\"#2-makefile-设计\" class=\"headerlink\" title=\"2.makefile 设计\"></a><strong>2.makefile 设计</strong></h1><h2 id=\"2-1-最简单方法\"><a href=\"#2-1-最简单方法\" class=\"headerlink\" title=\"2.1.最简单方法\"></a>2.1.最简单方法</h2><p>直接依赖项目中<code>.c</code>文件，通过 gcc 直接编译 C 文件。</p>\n<pre class=\"line-numbers language-makefile\" data-language=\"makefile\"><code class=\"language-makefile\">all:main.c mp3.c\n        gcc main.c mp3.c -o mp3</code></pre>\n\n<p>缺点：</p>\n<ul>\n<li>改变一个依赖文件（例：只 touch add.c 甚至不改变其内容），所有依赖文件都要重新更新编译</li>\n</ul>\n<h2 id=\"2-2-依赖于-o-文件\"><a href=\"#2-2-依赖于-o-文件\" class=\"headerlink\" title=\"2.2.依赖于.o 文件\"></a>2.2.依赖于.o 文件</h2><p>这次不依赖于项目中<code>.c</code>文件，而是依赖<code>.o</code>文件。</p>\n<pre class=\"line-numbers language-makefile\" data-language=\"makefile\"><code class=\"language-makefile\">all:mp3.o main.o\n        gcc mp3.o main.o -o mp3\n\nmain.o:main.c\n        gcc -c main.c -o main.o\n        echo &quot;make main&quot;\n\nmp3.o:mp3.c\n        gcc -c mp3.c -o mp3.o\n        echo &quot;make mp3&quot;</code></pre>\n\n<p>优点：</p>\n<ul>\n<li>相较于第一个版本，依赖于 .o 文件。<br>&nbsp;</li>\n<li>命令依然是 gcc，区别是由 .o 生成 app。<br>&nbsp;</li>\n<li>相较于第一版的好处是改变一个依赖文件，只有改变的依赖文件和终极目标需要重新生成，其他不动。</li>\n</ul>\n<p>缺点：</p>\n<ul>\n<li>相似代码体太多</li>\n</ul>\n<p>解决方法下一章变量会讲。</p>\n<h1 id=\"参考与致谢\"><a href=\"#参考与致谢\" class=\"headerlink\" title=\"参考与致谢\"></a><strong>参考与致谢</strong></h1><ul>\n<li><a href=\"https://codeantenna.com/a/wn3mNsg2pA\">Linux学习：makefile介绍 - CodeAntenna</a></li>\n</ul>\n","text":"1.搭建简单项目在一个文件夹中新建两个.c文件和一个Makefile文件。Makefile作为 make 编译文件，.c是项目文件。 这里我们搭建一个main.c和mp3.c，main.c负责调用mp3.c的函数。 main.c： #include &lt;stdio.h&gt;...","link":"","photos":[],"count_time":{"symbolsCount":951,"symbolsTime":"1 mins."},"categories":[{"name":"Linux","slug":"Linux","count":16,"path":"api/categories/Linux.json"}],"tags":[{"name":"Makefile","slug":"Makefile","count":7,"path":"api/tags/Makefile.json"},{"name":"编译","slug":"编译","count":7,"path":"api/tags/编译.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#1-%E6%90%AD%E5%BB%BA%E7%AE%80%E5%8D%95%E9%A1%B9%E7%9B%AE\"><span class=\"toc-text\">1.搭建简单项目</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#2-makefile-%E8%AE%BE%E8%AE%A1\"><span class=\"toc-text\">2.makefile 设计</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-1-%E6%9C%80%E7%AE%80%E5%8D%95%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">2.1.最简单方法</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-2-%E4%BE%9D%E8%B5%96%E4%BA%8E-o-%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">2.2.依赖于.o 文件</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%8F%82%E8%80%83%E4%B8%8E%E8%87%B4%E8%B0%A2\"><span class=\"toc-text\">参考与致谢</span></a></li></ol>","author":{"name":"Miraggio","slug":"blog-author","avatar":"https://s2.loli.net/2022/01/23/kntF9TEBOyHquwV.png","link":"https://lapzjfit.site","description":"喜欢研究奇奇怪怪的技术&游戏宅","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Makefile 序章","uid":"4f50b42c4f4b95dc4028325c472c0eea","slug":"Linux/All Makefile/Makefile 序章","date":"2022-02-05T12:49:36.000Z","updated":"2022-02-20T12:58:29.910Z","comments":true,"path":"api/articles/Linux/All Makefile/Makefile 序章.json","keywords":null,"cover":"https://s2.loli.net/2022/02/16/9BwocvuJ62WhIb8.jpg","text":"1. Makefile 简介在Linux开发环境下， 我们并没有太多的集成开发环境IDE，也就是说程序的所有控制权全部在于开发者，你势必要对底层软件的编译、链接、 装载有着相当深入的了解，才能说真正地驾驭了你的程序。 2. 学习目录 Makefile 三要素 引用 Makefil...","link":"","photos":[],"count_time":{"symbolsCount":200,"symbolsTime":"1 mins."},"categories":[{"name":"Linux","slug":"Linux","count":16,"path":"api/categories/Linux.json"}],"tags":[{"name":"Makefile","slug":"Makefile","count":7,"path":"api/tags/Makefile.json"},{"name":"编译","slug":"编译","count":7,"path":"api/tags/编译.json"}],"author":{"name":"Miraggio","slug":"blog-author","avatar":"https://s2.loli.net/2022/01/23/kntF9TEBOyHquwV.png","link":"https://lapzjfit.site","description":"喜欢研究奇奇怪怪的技术&游戏宅","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Makefile 函数","uid":"2b7c34b21c0bac89a496b7554225c02a","slug":"Linux/All Makefile/Makefile 函数/Makefile_Fun","date":"2022-02-05T12:49:36.000Z","updated":"2022-02-20T12:58:29.904Z","comments":true,"path":"api/articles/Linux/All Makefile/Makefile 函数/Makefile_Fun.json","keywords":null,"cover":"https://s2.loli.net/2022/02/16/cCGdo7tx2kPYjSH.jpg","text":"1. patsubst1.1. 基本语法 语法：模式替换函数—patsubst 1.2. 例程echo &quot;$(patsubst %.c,%.o,bar.c per.c io.c)&quot; 这里把字串“bar.c per.c io.c”中以 .c 结尾的单词替换成.o...","link":"","photos":[],"count_time":{"symbolsCount":"1k","symbolsTime":"1 mins."},"categories":[{"name":"Linux","slug":"Linux","count":16,"path":"api/categories/Linux.json"}],"tags":[{"name":"Makefile","slug":"Makefile","count":7,"path":"api/tags/Makefile.json"},{"name":"编译","slug":"编译","count":7,"path":"api/tags/编译.json"}],"author":{"name":"Miraggio","slug":"blog-author","avatar":"https://s2.loli.net/2022/01/23/kntF9TEBOyHquwV.png","link":"https://lapzjfit.site","description":"喜欢研究奇奇怪怪的技术&游戏宅","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}