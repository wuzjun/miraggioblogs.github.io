{"title":"简单四轮机器人","uid":"5ed1839713d43591c8a49ca17920825f","slug":"Webots/Basis/Wheeled Robot/Wheeled Robot","date":"2022-01-30T12:49:36.000Z","updated":"2022-02-08T16:30:33.738Z","comments":true,"path":"api/articles/Webots/Basis/Wheeled Robot/Wheeled Robot.json","keywords":null,"cover":"https://s2.loli.net/2022/02/08/cRgApP45ZNyhiqr.jpg","content":"<h1 id=\"1-四轮小车建立流程图\"><a href=\"#1-四轮小车建立流程图\" class=\"headerlink\" title=\"1. 四轮小车建立流程图\"></a><strong>1. 四轮小车建立流程图</strong></h1><p><img src=\"/post/Webots/Basis/Wheeled%20Robot/Wheeled%20Robot/Untitled.png\" alt=\"Untitled.png\"></p>\n<h1 id=\"2-四轮小车具体建立过程\"><a href=\"#2-四轮小车具体建立过程\" class=\"headerlink\" title=\"2. 四轮小车具体建立过程\"></a><strong>2. 四轮小车具体建立过程</strong></h1><h2 id=\"2-1-新建新世界\"><a href=\"#2-1-新建新世界\" class=\"headerlink\" title=\"2.1. 新建新世界\"></a>2.1. 新建新世界</h2><p>新建向导项目，创建一个地板<br>（<a href=\"https://lapzjfit.site/post/Webots%2FBasis%2FSimple%20model%2F%E7%AE%80%E5%8D%95%E6%A8%A1%E5%9E%8B%E4%BB%BF%E7%9C%9F\">简单模型仿真</a>）</p>\n<h2 id=\"2-2-建立小车\"><a href=\"#2-2-建立小车\" class=\"headerlink\" title=\"2.2. 建立小车\"></a>2.2. 建立小车</h2><h3 id=\"2-2-1-建立小车主体\"><a href=\"#2-2-1-建立小车主体\" class=\"headerlink\" title=\"2.2.1. 建立小车主体\"></a>2.2.1. 建立小车主体</h3><p>新建一个Robot节点，点击children，新增shape，宏定义为BODY</p>\n<p><img src=\"/post/Webots/Basis/Wheeled%20Robot/Wheeled%20Robot/Untitled%201.png\" alt=\"Untitled%201.png\"></p>\n<p>给该Shape新增纹理，geometry里新增box，宏定义为Box</p>\n<p><img src=\"/post/Webots/Basis/Wheeled%20Robot/Wheeled%20Robot/Untitled%202.png\" alt=\"Untitled%202.png\"></p>\n<h3 id=\"2-2-2-建立车轮\"><a href=\"#2-2-2-建立车轮\" class=\"headerlink\" title=\"2.2.2. 建立车轮\"></a>2.2.2. 建立车轮</h3><p>在Robot→children新增HingeJoint（铰链）节点</p>\n<p><img src=\"/post/Webots/Basis/Wheeled%20Robot/Wheeled%20Robot/Untitled%203.png\" alt=\"Untitled%203.png\"></p>\n<ul>\n<li>jointParameters：控制转动时的参数</li>\n<li>device：旋转设备</li>\n<li>endPoint：铰链另一端的连接的物体</li>\n</ul>\n<ol>\n<li><p>首先在endPoint新建Solid，再新建一个Shape，宏定义改为WHEEL</p>\n<p> Shape→geometry里创建Cylinder（圆柱体）<br> <img src=\"/post/Webots/Basis/Wheeled%20Robot/Wheeled%20Robot/Untitled%204.png\" alt=\"Untitled%204.png\"></p>\n</li>\n</ol>\n<ol start=\"2\">\n<li><p>调整轮子位置和角度</p>\n</li>\n<li><p>接着在device里新建电机<br> <img src=\"/post/Webots/Basis/Wheeled%20Robot/Wheeled%20Robot/Untitled%205.png\" alt=\"Untitled%205.png\"></p>\n<p> 最后在jointParameters里创建HingeJointParameters<br> <img src=\"/post/Webots/Basis/Wheeled%20Robot/Wheeled%20Robot/Untitled%206.png\" alt=\"Untitled%206.png\"></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>要注意的是，jointParameters→anchor是旋转中心，一般要把该点设置为该轮子坐标的中点，不然会出现奇奇怪怪的问题</p></blockquote>\n</li>\n<li><p>再设置碰撞属性，物理参数。</p>\n</li>\n</ol>\n<p>到这里一个轮子已经创建好了，接下来把该HingeJoint复制粘贴，得到4个。</p>\n<p>再把每一个HingeJoint里轮子的旋转中心，轮子的位置，电机宏，轮子宏修改后，可以开始编写控制器</p>\n<h2 id=\"2-3-编写控制器\"><a href=\"#2-3-编写控制器\" class=\"headerlink\" title=\"2.3. 编写控制器\"></a>2.3. 编写控制器</h2><p>创建新控制器模板后，把之前的电机控制器代码套进去</p>\n<pre class=\"line-numbers language-c\" data-language=\"c\"><code class=\"language-c\">#include &lt;webots&#x2F;robot.h&gt;\n\n&#x2F;&#x2F; Added a new include file\n#include &lt;webots&#x2F;motor.h&gt;\n\n#define TIME_STEP 64\n\nint main(int argc, char **argv)\n&#123;\n  wb_robot_init();\n\n  &#x2F;&#x2F; initialize motors\n  WbDeviceTag wheels[4];\n  char wheels_names[4][8] &#x3D; &#123;\n      &quot;motor1&quot;, &quot;motor2&quot;, &quot;motor3&quot;, &quot;motor4&quot;&#125;;\n  int i;\n  for (i &#x3D; 0; i &lt; 4; i++)\n  &#123;\n    wheels[i] &#x3D; wb_robot_get_device(wheels_names[i]);\n    wb_motor_set_position(wheels[i], INFINITY);\n  &#125;\n\n  while (wb_robot_step(TIME_STEP) !&#x3D; -1)\n  &#123;\n    double left_speed &#x3D; 1.0;\n    double right_speed &#x3D; 1.0;\n\n    wb_motor_set_velocity(wheels[0], left_speed);\n    wb_motor_set_velocity(wheels[1], right_speed);\n    wb_motor_set_velocity(wheels[2], left_speed);\n    wb_motor_set_velocity(wheels[3], right_speed);\n  &#125;\n\n  wb_robot_cleanup();\n\n  return 0;\n&#125;</code></pre>\n\n<p>编译控制器后，电机仿真，发现小车没动</p>\n<p>因为没有修改Robot里控制器，controller里选择为自己的新建控制器</p>\n<p><img src=\"/post/Webots/Basis/Wheeled%20Robot/Wheeled%20Robot/Untitled%207.png\" alt=\"Untitled%207.png\"></p>\n<p>在点仿真，就可以动了</p>\n<h1 id=\"参考与教程\"><a href=\"#参考与教程\" class=\"headerlink\" title=\"参考与教程\"></a><strong>参考与教程</strong></h1><p><a href=\"https://www.cyberbotics.com/doc/guide/tutorial-6-4-wheels-robot\">Webots: tutorial-6-4-w</a></p>\n","text":"1. 四轮小车建立流程图 2. 四轮小车具体建立过程2.1. 新建新世界新建向导项目，创建一个地板（简单模型仿真） 2.2. 建立小车2.2.1. 建立小车主体新建一个Robot节点，点击children，新增shape，宏定义为BODY 给该Shape新增纹理，geometry...","link":"","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[{"name":"运动仿真","slug":"运动仿真","count":16,"path":"api/categories/运动仿真.json"}],"tags":[{"name":"Webots","slug":"Webots","count":16,"path":"api/tags/Webots.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#1-%E5%9B%9B%E8%BD%AE%E5%B0%8F%E8%BD%A6%E5%BB%BA%E7%AB%8B%E6%B5%81%E7%A8%8B%E5%9B%BE\"><span class=\"toc-text\">1. 四轮小车建立流程图</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#2-%E5%9B%9B%E8%BD%AE%E5%B0%8F%E8%BD%A6%E5%85%B7%E4%BD%93%E5%BB%BA%E7%AB%8B%E8%BF%87%E7%A8%8B\"><span class=\"toc-text\">2. 四轮小车具体建立过程</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-1-%E6%96%B0%E5%BB%BA%E6%96%B0%E4%B8%96%E7%95%8C\"><span class=\"toc-text\">2.1. 新建新世界</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-2-%E5%BB%BA%E7%AB%8B%E5%B0%8F%E8%BD%A6\"><span class=\"toc-text\">2.2. 建立小车</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-2-1-%E5%BB%BA%E7%AB%8B%E5%B0%8F%E8%BD%A6%E4%B8%BB%E4%BD%93\"><span class=\"toc-text\">2.2.1. 建立小车主体</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-2-2-%E5%BB%BA%E7%AB%8B%E8%BD%A6%E8%BD%AE\"><span class=\"toc-text\">2.2.2. 建立车轮</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-3-%E7%BC%96%E5%86%99%E6%8E%A7%E5%88%B6%E5%99%A8\"><span class=\"toc-text\">2.3. 编写控制器</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%8F%82%E8%80%83%E4%B8%8E%E6%95%99%E7%A8%8B\"><span class=\"toc-text\">参考与教程</span></a></li></ol>","author":{"name":"Miraggio","slug":"blog-author","avatar":"https://s2.loli.net/2022/01/23/kntF9TEBOyHquwV.png","link":"https://lapzjfit.site","description":"喜欢研究奇奇怪怪的技术&游戏宅","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"简单模型仿真","uid":"509c30d25ef695d68dc7f877cde8022c","slug":"Webots/Basis/Simple model/简单模型仿真","date":"2022-01-30T12:49:36.000Z","updated":"2022-02-08T15:35:49.881Z","comments":true,"path":"api/articles/Webots/Basis/Simple model/简单模型仿真.json","keywords":null,"cover":"https://s2.loli.net/2022/02/07/KWjFM8RTYvoiks6.jpg","text":"1. 创建新世界那么最上面的两个节点是 Wordlnfo(世界信息）、Viewpoint(视角)。这两项是无法删除的Wordlnfo 里面有仿真物理学的一些参数，我们一般不修改这些参数 1.1. Wordlnfo Wordlnfo→basicTimeStep ：这个参数。它代表仿...","link":"","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[{"name":"运动仿真","slug":"运动仿真","count":16,"path":"api/categories/运动仿真.json"}],"tags":[{"name":"Webots","slug":"Webots","count":16,"path":"api/tags/Webots.json"}],"author":{"name":"Miraggio","slug":"blog-author","avatar":"https://s2.loli.net/2022/01/23/kntF9TEBOyHquwV.png","link":"https://lapzjfit.site","description":"喜欢研究奇奇怪怪的技术&游戏宅","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"HAL_UART中断代码的理解","uid":"5f63062ce45d7aec6b36bb6e5eaebe8a","slug":"cubeMX/HAL_UART中断函数","date":"2022-01-27T10:49:36.000Z","updated":"2022-02-08T15:35:50.084Z","comments":true,"path":"api/articles/cubeMX/HAL_UART中断函数.json","keywords":null,"cover":"https://s2.loli.net/2022/01/27/jHbGcYUgRyxr9kt.jpg","text":"这其实是对上一节 USART 和 DMA 方面的补充。 一方面是为了加深对中断代码的了解程度，另一方面是为了补充上一节没有写完的东西。 我们先重新来看看中断函数的具体结构。 void DR16_Handler(UART_HandleTypeDef *huart) &#123; i...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"Embedded","slug":"Embedded","count":19,"path":"api/categories/Embedded.json"}],"tags":[{"name":"HAL","slug":"HAL","count":14,"path":"api/tags/HAL.json"},{"name":"cubeMX","slug":"cubeMX","count":18,"path":"api/tags/cubeMX.json"}],"author":{"name":"Miraggio","slug":"blog-author","avatar":"https://s2.loli.net/2022/01/23/kntF9TEBOyHquwV.png","link":"https://lapzjfit.site","description":"喜欢研究奇奇怪怪的技术&游戏宅","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}