{"title":"创建三全向轮小车","uid":"86336032c6ac02563b9014b8bacea503","slug":"Webots/Application/omni wheel/创建三全向轮小车","date":"2022-01-30T12:49:36.000Z","updated":"2022-02-08T16:30:33.688Z","comments":true,"path":"api/articles/Webots/Application/omni wheel/创建三全向轮小车.json","keywords":null,"cover":"https://s2.loli.net/2022/02/08/uk4st92T1lxBzEf.jpg","content":"<p>官方有开源的全向轮模型，可以先尝试自己建立</p>\n<p>下面我会讲我的思路，默认添加物理属性和碰撞属性。</p>\n<h1 id=\"1-搭建躯干\"><a href=\"#1-搭建躯干\" class=\"headerlink\" title=\"1.搭建躯干\"></a><strong>1.搭建躯干</strong></h1><p>我们先创建一个 Robot 节点，在 children 里面先建立一个 Transform 节点。这样可以使小车躯干在 Robot（父级）坐标下进行移动。</p>\n<p>我在 Transform→children 创建一个 Shape，创建一个圆柱体作为小车的躯干。</p>\n<p><img src=\"/post/Webots/Application/omni%20wheel/%E5%88%9B%E5%BB%BA%E4%B8%89%E5%85%A8%E5%90%91%E8%BD%AE%E5%B0%8F%E8%BD%A6/Untitled.png\" alt=\"Untitled.png\"></p>\n<h1 id=\"2-创建一个全向轮\"><a href=\"#2-创建一个全向轮\" class=\"headerlink\" title=\"2.创建一个全向轮\"></a><strong>2.创建一个全向轮</strong></h1><p>接着在 Robot→children 里创建一个 HingeJoint（铰链），该节点将作为其中一个轮子的总节点。</p>\n<p>旋转轴和旋转中心最后再确定，在 endPoint 中创建一个 soild，该 soild 包含轮子所有需要的节点。</p>\n<p>一个全向轮包含以下内容：</p>\n<ul>\n<li>9 个可以活动的辊子</li>\n<li>一个轮毂</li>\n</ul>\n<h2 id=\"2-1-创建轮毂\"><a href=\"#2-1-创建轮毂\" class=\"headerlink\" title=\"2.1.创建轮毂\"></a>2.1.创建轮毂</h2><p>我们先一个创建轮毂，在 Robot→children→HingeJoint→soild→children 里创建一个 Transform（宏定义为DEF WHEEL_TRANS Transform），新建一个 shape→Cylinder，修改形状，旋转 DEF_WHEEL_TRANS_Transform 里面的坐标轴，使其变成轮毂的形状。（红色的辊子先忽略）</p>\n<p><img src=\"/post/Webots/Application/omni%20wheel/%E5%88%9B%E5%BB%BA%E4%B8%89%E5%85%A8%E5%90%91%E8%BD%AE%E5%B0%8F%E8%BD%A6/Untitled%201.png\" alt=\"Untitled%201.png\"></p>\n<h2 id=\"2-2-创建辊子\"><a href=\"#2-2-创建辊子\" class=\"headerlink\" title=\"2.2.创建辊子\"></a>2.2.创建辊子</h2><p>我们只需要确定辊子的形状、几何中心、旋转轴和旋转中心即可。</p>\n<p><img src=\"/post/Webots/Application/omni%20wheel/%E5%88%9B%E5%BB%BA%E4%B8%89%E5%85%A8%E5%90%91%E8%BD%AE%E5%B0%8F%E8%BD%A6/Untitled%202.png\" alt=\"Untitled%202.png\"></p>\n<h3 id=\"2-2-1-移动并旋转辊子到合适的位置\"><a href=\"#2-2-1-移动并旋转辊子到合适的位置\" class=\"headerlink\" title=\"2.2.1.移动并旋转辊子到合适的位置\"></a>2.2.1.移动并旋转辊子到合适的位置</h3><ul>\n<li><p>在 Robot→children→HingeJoint→soild 里继续创建 HingeJoint（宏定义为DEF sr1 HingeJoint），在 DEF sr1 HingeJoint→endPoint 中创建一个 soild。</p>\n</li>\n<li><p>调整 DEF sr1 HingeJoint 里坐标轴，调整坐标的坐标点到图上 D 点处。</p>\n</li>\n<li><p>接着在 DEF sr1 HingeJoint→children 里新建一个 Transform（宏定义为DEF r1 Transform）。</p>\n</li>\n<li><p>DEF r1 Transform→children 里新建一个 shape，选择圆柱体。</p>\n</li>\n<li><p>在 DEF r1 HingeJoint 调整辊子 translation，使得如上图所示的辊子，以每隔四十度角排列。</p>\n</li>\n<li><p>再调整 DEF r1 Transform 的 rotation，使得辊子沿着轮毂的切线方向</p>\n</li>\n</ul>\n<p>这样可以使得 DEF sr1 HingeJoint 的坐标不变，只会以 DEF sr1 HingeJoint 坐标为前提下改变方向，使得移动该辊子的时候可以整个移动，移动到合适的点后再旋转方向。</p>\n<p>图中 D’、D’’ 等都可以通过半径 *sin/cos 来求得 X、Y 的偏移量。</p>\n<hr>\n<p>例如：要把辊子移动到 D’</p>\n<ul>\n<li>在DEF r1 HingeJoint的translation输入算出来的X、Y的偏移量。</li>\n<li>坐标点移到之后，旋转辊子的rotation，使得方向与轮毂切线方向平行。</li>\n</ul>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>ratation 不能直接给角度，只能通过调整 X、Y、Z 轴的大小来控制角度。</p></blockquote>\n<p><img src=\"/post/Webots/Application/omni%20wheel/%E5%88%9B%E5%BB%BA%E4%B8%89%E5%85%A8%E5%90%91%E8%BD%AE%E5%B0%8F%E8%BD%A6/Untitled%203.png\" alt=\"Untitled%203.png\"></p>\n<p>其中的一个辊子</p>\n<p><img src=\"/post/Webots/Application/omni%20wheel/%E5%88%9B%E5%BB%BA%E4%B8%89%E5%85%A8%E5%90%91%E8%BD%AE%E5%B0%8F%E8%BD%A6/Untitled%204.png\" alt=\"Untitled%204.png\"></p>\n<h3 id=\"2-2-2-设置辊子旋转轴的位置\"><a href=\"#2-2-2-设置辊子旋转轴的位置\" class=\"headerlink\" title=\"2.2.2.设置辊子旋转轴的位置\"></a>2.2.2.设置辊子旋转轴的位置</h3><p>旋转轴默认不显示，查看→可选显示→show Joint Axes 并勾上。</p>\n<p>之后会看到一条黑细的一条线，那条就是旋转轴。</p>\n<p>旋转轴在 DEF sr1 HingeJoint→jointParameters 里调整，axis 是调整旋转轴，anchor 是调整旋转中心。</p>\n<p><img src=\"/post/Webots/Application/omni%20wheel/%E5%88%9B%E5%BB%BA%E4%B8%89%E5%85%A8%E5%90%91%E8%BD%AE%E5%B0%8F%E8%BD%A6/Untitled%205.png\" alt=\"Untitled%205.png\"></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>旋转中心一般与endPoint里的translation（即铰链的物体坐标点）相同即可</p></blockquote>\n<h3 id=\"2-2-3-设置整个轮子的旋转参数\"><a href=\"#2-2-3-设置整个轮子的旋转参数\" class=\"headerlink\" title=\"2.2.3.设置整个轮子的旋转参数\"></a>2.2.3.设置整个轮子的旋转参数</h3><p>按照上述方法确定旋转轴和旋转中心，device里选择电机，并把电机重命名（作为后续代码的句柄），轮子创建完成。</p>\n<h1 id=\"3-完整小车\"><a href=\"#3-完整小车\" class=\"headerlink\" title=\"3.完整小车\"></a><strong>3.完整小车</strong></h1><p>建好一个轮子后，把另外两个轮子复制出来名字重新命名。先把两个轮子坐标点全部清0（回到零点），接着把两个轮子分别顺时针转和逆时针转120°，再沿着第一个轮子的轴往前拉动相同距离。</p>\n<h1 id=\"4-代码\"><a href=\"#4-代码\" class=\"headerlink\" title=\"4.代码\"></a><strong>4.代码</strong></h1><p>在之前的基础上加入三轮运动模型即可。</p>\n<pre class=\"line-numbers language-c\" data-language=\"c\"><code class=\"language-c\">const float Radian &#x3D; 3.14159 &#x2F; 6;\n\ntempSpeed[0] &#x3D; -Vx + VOmega;\ntempSpeed[1] &#x3D; Vx * sin(Radian) - Vy * cos(Radian) + VOmega;\ntempSpeed[2] &#x3D; Vx * sin(Radian) + Vy * cos(Radian) + VOmega;</code></pre>\n\n<h1 id=\"参考与致谢\"><a href=\"#参考与致谢\" class=\"headerlink\" title=\"参考与致谢\"></a><strong>参考与致谢</strong></h1><p><a href=\"https://www.cyberbotics.com/doc/guide/samples-howto\">Webots: 全向轮搭建</a></p>\n","text":"官方有开源的全向轮模型，可以先尝试自己建立 下面我会讲我的思路，默认添加物理属性和碰撞属性。 1.搭建躯干我们先创建一个 Robot 节点，在 children 里面先建立一个 Transform 节点。这样可以使小车躯干在 Robot（父级）坐标下进行移动。 我在 Transf...","link":"","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"运动仿真","slug":"运动仿真","count":16,"path":"api/categories/运动仿真.json"}],"tags":[{"name":"Webots","slug":"Webots","count":16,"path":"api/tags/Webots.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#1-%E6%90%AD%E5%BB%BA%E8%BA%AF%E5%B9%B2\"><span class=\"toc-text\">1.搭建躯干</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#2-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%85%A8%E5%90%91%E8%BD%AE\"><span class=\"toc-text\">2.创建一个全向轮</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-1-%E5%88%9B%E5%BB%BA%E8%BD%AE%E6%AF%82\"><span class=\"toc-text\">2.1.创建轮毂</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-2-%E5%88%9B%E5%BB%BA%E8%BE%8A%E5%AD%90\"><span class=\"toc-text\">2.2.创建辊子</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-2-1-%E7%A7%BB%E5%8A%A8%E5%B9%B6%E6%97%8B%E8%BD%AC%E8%BE%8A%E5%AD%90%E5%88%B0%E5%90%88%E9%80%82%E7%9A%84%E4%BD%8D%E7%BD%AE\"><span class=\"toc-text\">2.2.1.移动并旋转辊子到合适的位置</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-2-2-%E8%AE%BE%E7%BD%AE%E8%BE%8A%E5%AD%90%E6%97%8B%E8%BD%AC%E8%BD%B4%E7%9A%84%E4%BD%8D%E7%BD%AE\"><span class=\"toc-text\">2.2.2.设置辊子旋转轴的位置</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-2-3-%E8%AE%BE%E7%BD%AE%E6%95%B4%E4%B8%AA%E8%BD%AE%E5%AD%90%E7%9A%84%E6%97%8B%E8%BD%AC%E5%8F%82%E6%95%B0\"><span class=\"toc-text\">2.2.3.设置整个轮子的旋转参数</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#3-%E5%AE%8C%E6%95%B4%E5%B0%8F%E8%BD%A6\"><span class=\"toc-text\">3.完整小车</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#4-%E4%BB%A3%E7%A0%81\"><span class=\"toc-text\">4.代码</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%8F%82%E8%80%83%E4%B8%8E%E8%87%B4%E8%B0%A2\"><span class=\"toc-text\">参考与致谢</span></a></li></ol>","author":{"name":"Miraggio","slug":"blog-author","avatar":"https://s2.loli.net/2022/01/23/kntF9TEBOyHquwV.png","link":"https://lapzjfit.site","description":"喜欢研究奇奇怪怪的技术&游戏宅","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"建立 2021RC 图纸","uid":"dc9eb118380877df3be3b78227a1a198","slug":"Webots/Application/RC map/2021RC 图纸","date":"2022-01-30T12:49:36.000Z","updated":"2022-02-08T17:10:46.718Z","comments":true,"path":"api/articles/Webots/Application/RC map/2021RC 图纸.json","keywords":null,"cover":"https://s2.loli.net/2022/02/09/2sMCWbBZxHLzaJO.jpg","text":"1.Soliworks 导出图纸到 Webots2021RC 场地中间有三个可活动的壶，三个壶分别定义为三个关节，启动区，地板，线等分别单独作为一个Solid导出，总体导出为一个Robot节点。（后面会说为什么要这样导出） 2.建立场地地板其实小车也可以在原Robot节点上跑，但...","link":"","photos":[],"count_time":{"symbolsCount":"1k","symbolsTime":"1 mins."},"categories":[{"name":"运动仿真","slug":"运动仿真","count":16,"path":"api/categories/运动仿真.json"}],"tags":[{"name":"Webots","slug":"Webots","count":16,"path":"api/tags/Webots.json"}],"author":{"name":"Miraggio","slug":"blog-author","avatar":"https://s2.loli.net/2022/01/23/kntF9TEBOyHquwV.png","link":"https://lapzjfit.site","description":"喜欢研究奇奇怪怪的技术&游戏宅","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"添加摄像头","uid":"c9ce92de968e539fb260956b4d902ffd","slug":"Webots/Application/camera/添加摄像头","date":"2022-01-30T12:49:36.000Z","updated":"2022-02-08T16:54:10.437Z","comments":true,"path":"api/articles/Webots/Application/camera/添加摄像头.json","keywords":null,"cover":"https://s2.loli.net/2022/02/09/kuC42m1ySOQohY7.jpg","text":"1.添加camera实体在Robot中添加 camera（camera相机） 设置这个 camera 相机的children中添加 transform 节点， 设置这个 transform 节点的children中添加shape节点，并设置外观和形状。设置半径 0.01 高度0....","link":"","photos":[],"count_time":{"symbolsCount":"3.3k","symbolsTime":"3 mins."},"categories":[{"name":"运动仿真","slug":"运动仿真","count":16,"path":"api/categories/运动仿真.json"}],"tags":[{"name":"Webots","slug":"Webots","count":16,"path":"api/tags/Webots.json"}],"author":{"name":"Miraggio","slug":"blog-author","avatar":"https://s2.loli.net/2022/01/23/kntF9TEBOyHquwV.png","link":"https://lapzjfit.site","description":"喜欢研究奇奇怪怪的技术&游戏宅","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}